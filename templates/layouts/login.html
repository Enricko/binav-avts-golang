{{ template "header" . }}
<style>
  body,
  html {
    height: 100%;
  }
  .navbar {
    background-color: #0e286c;
  }
  .content-wrapper {
    height: calc(100vh - 56px); /* Adjust based on your navbar height */
  }
  .carousel-wrapper {
    height: 100%;
  }
  .carousel-inner {
    height: 100%;
  }
  .carousel-item {
    height: 100%;
  }
  .carousel-item img {
    object-fit: cover;
    height: 100%;
    width: 100%;
  }
  .form-wrapper {
    display: flex;
    flex-direction: column;
    justify-content: center;
    padding: 2rem;
    background-color: white;
  }
  @media (max-width: 767.98px) {
    .carousel-wrapper {
      display: none;
    }
    .form-wrapper {
      height: 100%;
    }
  }
  .circular-button {
    width: 40px;
    height: 40px;
    border: 2px solid #000; /* Black border */
    border-radius: 50%; /* Make it circular */
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: #000; /* Black background */
    transition: background-color 0.3s ease, border-color 0.3s ease;
  }

  .circular-button:hover {
    background-color: #414141; /* Slightly lighter black on hover */
    border-color: #414141;
  }

  .circular-button svg {
    width: 24px;
    height: 24px;
    fill: #fff; /* White arrow */
  }
</style>
<nav class="navbar navbar-dark">
  <div class="container-fluid">
    <span class="navbar-brand">AVTS - Automated Vessel Tracking System</span>
  </div>
</nav>

<div class="content-wrapper">
  <div class="row g-0 h-100">
    <div class="col-md-6 carousel-wrapper">
      <div
        id="loginCarousel"
        class="carousel slide h-100"
        data-bs-ride="carousel"
      >
        <div class="carousel-inner">
          <div class="carousel-item active">
            <img
              src="/public/assets/intro1.jpg"
              class="d-block w-100"
              alt="Intro 1"
            />
          </div>
          <div class="carousel-item">
            <img
              src="/public/assets/intro2.jpg"
              class="d-block w-100"
              alt="Intro 2"
            />
          </div>
          <div class="carousel-item">
            <img
              src="/public/assets/intro3.jpg"
              class="d-block w-100"
              alt="Intro 3"
            />
          </div>
        </div>
        <button
          class="carousel-control-prev"
          type="button"
          data-bs-target="#loginCarousel"
          data-bs-slide="prev"
        >
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Previous</span>
        </button>
        <button
          class="carousel-control-next"
          type="button"
          data-bs-target="#loginCarousel"
          data-bs-slide="next"
        >
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Next</span>
        </button>
      </div>
    </div>
    <div class="col-md-6 form-wrapper">
      <div id="loginForm">
        <img
          src="/public/assets/logo_transparent.png"
          alt="Logo"
          style="width: 100px; margin-bottom: 1rem"
        />
        <h5 class="fw-bold">Hi, Welcome to Binav AVTS</h5>
        <h5 class="fw-bold mb-4">Log in to your Account</h5>
        <br />
        <form id="login-form">
          <div class="mb-3">
            <!-- <label for="email" class="form-label">Email address</label> -->
            <input
              type="email"
              class="form-control"
              id="email"
              name="email"
              aria-describedby="emailHelp"
              required
              placeholder="Email"
            />
          </div>
          <div class="mb-3">
            <!-- <label for="password" class="form-label">Password</label> -->
            <div class="input-group">
              <input
                type="password"
                class="form-control"
                name="password"
                id="password"
                required
                placeholder="Password"
              />
              <button
                class="btn btn-outline-secondary"
                type="button"
                id="togglePassword"
              >
                <i class="bi bi-eye" id="toggleIcon"></i>
              </button>
            </div>
          </div>
          <div class="d-flex justify-content-end mb-3">
            <button
              type="button"
              class="btn btn-link p-0"
              onclick="showForgotPassword()"
            >
              Forgot Password?
            </button>
          </div>
          <button type="submit" class="btn btn-primary w-100" id="btn-login">
            Login
          </button>
        </form>
      </div>

      <div id="forgotPasswordForm" style="display: none">
        <button
          type="button"
          class="btn p-0 me-3 mb-4"
          onclick="showLoginForm()"
          aria-label="Go back to login"
        >
          <div
            class="circular-button"
            style="background-color: #0e286c; border: #0e286c"
          >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
              <path
                fill-rule="evenodd"
                d="M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8z"
              />
            </svg>
          </div>
        </button>
        <h5 class="fw-bold mb-4">Forgot Password</h5>
        <p>
          Enter your email and we'll send you an OTP code to reset your
          password.
        </p>
        <form id="forgot-password-form">
          <div class="mb-4">
            <!-- <label for="forgotEmail" class="form-label">Email address</label> -->
            <input
              name="email"
              type="email"
              class="form-control"
              id="forgotEmail"
              required
              placeholder="Email Address"
            />
          </div>
          <button
            id="btn-forgot"
            type="submit"
            class="btn btn-primary w-100 mb-3"
          >
            Send OTP Code
          </button>
          <!-- <button type="button" class="btn btn-link w-100" onclick="showLoginForm()">Back to Login</button> -->
        </form>
      </div>

      <div id="OtpForm" style="display: none">
        <button
          type="button"
          class="btn p-0 me-3 mb-4"
          onclick="showForgotPassForm()"
          aria-label="Go back to login"
        >
          <div
            class="circular-button"
            style="background-color: #0e286c; border: #0e286c"
          >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
              <path
                fill-rule="evenodd"
                d="M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8z"
              />
            </svg>
          </div>
        </button>
        <h5 class="fw-bold mb-2">OTP Verification</h5>
        <p id="otpSubtitle" class="mb-3">We've sent a code to your Email</p>
        <form id="otp-form">
          <div class="d-flex justify-content-center mb-4">
            <input
              type="text"
              class="form-control otp-input"
              maxlength="1"
              id="otp1"
              oninput="moveToNext(this, 'otp2')"
              onkeydown="moveToPrevious(event, this, null)"
              required
            />
            <input
              type="text"
              class="form-control otp-input"
              maxlength="1"
              id="otp2"
              oninput="moveToNext(this, 'otp3')"
              onkeydown="moveToPrevious(event, this, 'otp1')"
              required
            />
            <input
              type="text"
              class="form-control otp-input"
              maxlength="1"
              id="otp3"
              oninput="moveToNext(this, 'otp4')"
              onkeydown="moveToPrevious(event, this, 'otp2')"
              required
            />
            <input
              type="text"
              class="form-control otp-input"
              maxlength="1"
              id="otp4"
              oninput="moveToNext(this, 'otp5')"
              onkeydown="moveToPrevious(event, this, 'otp3')"
              required
            />
            <input
              type="text"
              class="form-control otp-input"
              maxlength="1"
              id="otp5"
              oninput="moveToNext(this, 'otp6')"
              onkeydown="moveToPrevious(event, this, 'otp4')"
              required
            />
            <input
              type="text"
              class="form-control otp-input"
              maxlength="1"
              id="otp6"
              onkeydown="moveToPrevious(event, this, 'otp5')"
              required
            />
          </div>
          <button
            id="btn-submit-otp"
            type="submit"
            class="btn btn-primary w-100 mb-3"
          >
            Submit
          </button>
        </form>
      </div>

      <div id="ResetPassForm" style="display: none">
        <button
          type="button"
          class="btn p-0 me-3 mb-4"
          onclick="showLoginForm()"
          aria-label="Go back to login"
        >
          <div
            class="circular-button"
            style="background-color: #0e286c; border: #0e286c"
          >
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
              <path
                fill-rule="evenodd"
                d="M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8z"
              />
            </svg>
          </div>
        </button>
        <h5 class="fw-bold mb-2">Change Your Password</h5>
        <p id="otpSubtitle" class="mb-3">
          Enter a new password below to change your password
        </p>
        <form id="reset-pass-form">
          <div class="mb-3">
            <label for="new_password" class="form-label">New Password</label>
            <input
              type="password"
              class="form-control"
              id="new_password"
              name="new_password"
              required
              placeholder="New Password"
            />
          </div>
          <div class="mb-3">
            <label for="password" class="form-label">Confirm Password</label>
            <input
              type="password"
              class="form-control"
              id="confirmation_password"
              name="confirmation_password"
              required
              placeholder="Confirm your Password"
            />
          </div>
          <button
            id="btn-reset-pass"
            type="submit"
            class="btn btn-primary w-100 mb-3"
          >
            Submit
          </button>
        </form>
      </div>
    </div>
  </div>
</div>
<!-- Alert Modal -->
<div
  class="modal fade"
  id="errorModal"
  tabindex="-1"
  aria-labelledby="errorModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="errorModalLabel">Error</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body" id="title-alert">
        Invalid Email or password. Please try again.
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
          Close
        </button>
      </div>
    </div>
  </div>
</div>

<div
  class="modal fade"
  id="successModal"
  tabindex="-1"
  aria-labelledby="errorModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="successModalLabel">Success</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body" id="title-alert">
        Your Password has been updated successfully
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
          Close
        </button>
      </div>
    </div>
  </div>
</div>

<script>
  function showForgotPassword() {
    document.getElementById("loginForm").style.display = "none";
    document.getElementById("forgotPasswordForm").style.display = "block";
  }

  function showLoginForm() {
    document.getElementById("loginForm").style.display = "block";
    document.getElementById("forgotPasswordForm").style.display = "none";
  }

  function showForgotPassForm() {
    document.getElementById("OtpForm").style.display = "none";
    document.getElementById("forgotPasswordForm").style.display = "block";
  }

  // function handleSubmit() {
  //   event.preventDefault();
  //     document.getElementById('forgotPasswordForm').style.display = 'none';
  //     document.getElementById('OtpForm').style.display = 'block';
  //     const email = document.getElementById('forgotEmail').value;
  //     document.getElementById('otpSubtitle').innerHTML = `We've sent a code to <strong>${email}</strong>`;
  // }
  // document.getElementById('forgot-password-form').addEventListener('submit', handleSubmit);

  document
    .getElementById("login-form")
    .addEventListener("submit", function (e) {
      e.preventDefault();
      // Add your login logic here
      console.log("Login attempted");
    });

  document
    .getElementById("forgot-password-form")
    .addEventListener("submit", function (e) {
      e.preventDefault();
      // Add your forgot password logic here
      console.log("Forgot password submitted");
    });

  const togglePassword = document.querySelector("#togglePassword");
  const password = document.querySelector("#password");
  const toggleIcon = document.querySelector("#toggleIcon");

  togglePassword.addEventListener("click", function () {
    // Toggle the type attribute
    const type =
      password.getAttribute("type") === "password" ? "text" : "password";
    password.setAttribute("type", type);

    // Toggle the icon
    toggleIcon.classList.toggle("bi-eye");
    toggleIcon.classList.toggle("bi-eye-slash");
  });

  function moveToNext(current, nextFieldID) {
    if (current.value.length >= 1) {
      document.getElementById(nextFieldID).focus();
    }
  }
  function moveToPrevious(event, currentElement, previousFieldID) {
    if (
      event.key === "Backspace" &&
      currentElement.value === "" &&
      previousFieldID
    ) {
      document.getElementById(previousFieldID).focus();
    }
  }

  document.getElementById("otpForm").addEventListener("submit", function (e) {
    e.preventDefault();
    let otp = "";
    for (let i = 1; i <= 6; i++) {
      otp += document.getElementById("otp" + i).value;
    }
    alert("OTP Entered: " + otp);
    // Here you can send the OTP value to your server for verification
  });
</script>

<script src="/public/scripts/auth.js"></script>

{{ template "footer" . }}
